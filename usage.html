<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at Feb 23, 2013
 | Rendered using Apache Maven Fluido Skin 1.3.0
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Xavier Cho" />
    <meta name="Date-Creation-yyyymmdd" content="20121118" />
    <meta name="Date-Revision-yyyymmdd" content="20130223" />
    <meta http-equiv="Content-Language" content="en" />
    <title>Pivot4J - How to Use</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.3.0.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    
    
  
    <script type="text/javascript" src="./js/apache-maven-fluido-1.3.0.min.js"></script>

                          
        
<meta content="1eTr2b9TBltzvRgJMurNfI32T-3xJVGEV-E-lqfGMwU" name="google-site-verification"/>
          
              <!-- Google Analytics -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-38197551-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/mysticfall/pivot4j">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>Pivot4J</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2013-02-23</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 0.7-SNAPSHOT</li>
                      
                
            
      
                                              
    <li class="pull-right">              <a href="https://github.com/mysticfall/pivot4j" class="externalLink" title="GitHub Project Page">
        GitHub Project Page</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="http://www.olap4j.org" class="externalLink" title="Olap4J Project">
        Olap4J Project</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="http://community.pentaho.com" class="externalLink" title="Pentaho Community">
        Pentaho Community</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="http://jpivot.sourceforge.net" class="externalLink" title="JPivot Project">
        JPivot Project</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="http://groups.google.com/d/forum/pivot4j-list" class="externalLink" title="Discussions">
        Discussions</a>
  </li>

        <li class="divider pull-right">|</li>
      
    <li class="pull-right">              <a href="https://github.com/mysticfall/pivot4j/issues" class="externalLink" title="Issue Tracker">
        Issue Tracker</a>
  </li>

                        </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span3">
          <div class="well sidebar-nav">
                
            
                <ul class="nav nav-list">
                    <li class="nav-header">Overview</li>
                                
      <li>
    
                          <a href="index.html" title="Introduction">
          <i class="none"></i>
        Introduction</a>
            </li>
                  
      <li>
    
                          <a href="example.html" title="Sample Application">
          <i class="none"></i>
        Sample Application</a>
            </li>
                  
      <li>
    
                          <a href="pentaho.html" title="Pentaho BI Plugin">
          <i class="none"></i>
        Pentaho BI Plugin</a>
            </li>
                  
      <li>
    
                          <a href="download.html" title="Download">
          <i class="none"></i>
        Download</a>
            </li>
                  
      <li class="active">
    
            <a href="#"><i class="none"></i>How to Use</a>
          </li>
                  
      <li>
    
                          <a href="developer.html" title="For Developers">
          <i class="none"></i>
        For Developers</a>
            </li>
                  
      <li>
    
                          <a href="faq.html" title="FAQ">
          <i class="none"></i>
        FAQ</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                                                                  
      <li>
    
                          <a href="project-info.html" title="Project Information">
          <i class="icon-chevron-right"></i>
        Project Information</a>
                  </li>
                                                                                                                                                                                                                                      
      <li>
    
                          <a href="project-reports.html" title="Project Reports">
          <i class="icon-chevron-right"></i>
        Project Reports</a>
                  </li>
            </ul>
                
            
                            <form id="search-form" action="http://www.google.com/search" method="get" >
    
  <input value="mysticfall.github.com/pivot4j" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="http://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr class="divider" />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
               
        
        
        <div id="twitter">
    
    <a href="https://twitter.com/pivot4j" class="twitter-follow-button" data-show-count="true" data-align="left" data-size="medium" data-show-screen-name="true" data-lang="en">Follow pivot4j</a>
    <script type="text/javascript">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

        </div>
                   <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span9" >
                                  
            <div class="section"><h2>How to Use Pivot4J<a name="How_to_Use_Pivot4J"></a></h2><div class="section"><h3>System Requirement<a name="System_Requirement"></a></h3><ul><li>Java 1.6 or higher</li><li><a class="externalLink" href="http://mondrian.pentaho.com">Mondrian</a> or any other XMLA based OLAP server which is supported by Olap4J.</li></ul></div><div class="section"><h3>Maven Project Setup<a name="Maven_Project_Setup"></a></h3><p>If you're using <a class="externalLink" href="http://maven.apache.org">Maven</a>, update your pom.xml as below :</p><div class="source"><pre class="prettyprint linenums">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;project&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;some-project&lt;/groupId&gt;
    &lt;artifactId&gt;some-project&lt;/artifactId&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;
    &lt;name&gt;My Project&lt;/name&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;repositories&gt;
        &lt;repository&gt;
            &lt;id&gt;eyeq&lt;/id&gt;
            &lt;url&gt;http://dev.eyeq.co.kr/artifactory/libs-release/&lt;/url&gt;
        &lt;/repository&gt;
    &lt;/repositories&gt;
    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;com.eyeq&lt;/groupId&gt;
            &lt;artifactId&gt;pivot4j&lt;/artifactId&gt;
            &lt;version&gt;0.6&lt;/version&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;
&lt;/project&gt;</pre></div><p>Or if you use any other build method which depends on Maven repository, please see <a href="./dependency-info.html">this page</a>. Of course, also you can just download the all the related jar files and import them manually. In that case, <a href="./dependencies.html">this page</a> might help determining which library files are required.</p></div><div class="section"><h3>Setting up a Data Source<a name="Setting_up_a_Data_Source"></a></h3><p>You need to create a data source to connect to the OLAP server. There are several implementations in <a href="./apidocs/com/eyeq/pivot4j/datasource/package-summary.html">com.eyeq.pivot4j.datasource</a> package.</p><p>For most of the cases, you can use <a href="./apidocs/com/eyeq/pivot4j/datasource/SimpleOlapDataSource.html">SimpleOlapDataSource</a> as below :</p><div class="source"><pre class="prettyprint linenums">SimpleOlapDataSource dataSource = new SimpleOlapDataSource();
dataSource.setConnectionString(&quot;jdbc:mondrian:Jdbc=jdbc:odbc:MondrianFoodMart;Catalog=FoodMart.xml;&quot;);</pre></div><p>For detailed information on how to configure the connection string, please see the <a class="externalLink" href="http://www.olap4j.org/olap4j_fs.html#Connections">Olap4J manual</a> for reference. </p><p>If you have already an active OlapConnection or DataSource instance, then you can use either <a href="./apidocs/com/eyeq/pivot4j/datasource/SingleConnectionOlapDataSource.html">SingleConnectionOlapDataSource</a> or <a href="./apidocs/com/eyeq/pivot4j/datasource/WrappingOlapDataSource.html">WrappingOlapDataSource</a> to wrap them as an OlapDataSource.</p><p>For connection pooling, you can use the <a href="./apidocs/com/eyeq/pivot4j/datasource/PooledOlapDataSource.html">PooledOlapDataSource</a> as below :</p><div class="source"><pre class="prettyprint linenums">GenericObjectPool.Config config = new GenericObjectPool.Config();
config.maxActive = 3;
config.maxIdle = 3;

PooledOlapDataSource dataSource = new PooledOlapDataSource(dataSource, config);</pre></div><p>For detailed instruction on how to configure the connection pool settings, please see the <a class="externalLink" href="http://commons.apache.org/pool/apidocs/org/apache/commons/pool/impl/GenericObjectPool.html">Commons Pool API</a> for reference. </p></div><div class="section"><h3>Creating a PivotModel<a name="Creating_a_PivotModel"></a></h3><p>Create a PivotModel using the default implementation class as below :</p><div class="source"><pre class="prettyprint linenums">String initialMdx = &quot;SELECT {[Measures].[Unit Sales], [Measures].[Store Cost], [Measures].[Store Sales]} ON COLUMNS, &quot;
                        + &quot;{([Promotion Media].[All Media], [Product].[All Products])} ON ROWS FROM [Sales]&quot;;

PivotModel model = new PivotModelImpl(dataSource);
model.setMdx(initialMdx);
model.initialize();</pre></div><p>Note that <tt>initail MDX query should be specified</tt> before invoking the <b>initialize()</b> method. (Except for when you restore the model's state from the previous session.)</p></div><div class="section"><h3>Executing a Query<a name="Executing_a_Query"></a></h3><p>Call <a href="./apidocs/com/eyeq/pivot4j/PivotModel.html#getCellSet2829">PivotModel.getCellSet()</a> method to execute the initial MDX query and get the query result as below :</p><div class="source"><pre class="prettyprint linenums">CellSet cellSet = model.getCellSet();

// Axes of the resulting query.
List&lt;CellSetAxis&gt; axes = cellSet.getAxes();

// The COLUMNS axis
CellSetAxis columns = axes.get(0);

// The ROWS axis
CellSetAxis rows = axes.get(1);

// Member positions of the ROWS axis.
List&lt;Position&gt; positions = rows.getPositions();</pre></div><p>For detailed usage, please refer to the <a class="externalLink" href="http://www.olap4j.org/head/api/org/olap4j/CellSet.html">Olap4J API document</a>.</p></div><div class="section"><h3>Transforming a Query<a name="Transforming_a_Query"></a></h3><p>There are several query transform operations like swapping the axes, drilling down on position, and so on defined in <a href="./apidocs/com/eyeq/pivot4j/transform/package-summary.html">com.eyeq.pivot4j.transform</a> package.</p><p>To perform a transform operation, get a proper Transform instance then invoke the proper methods for each transformation.</p><p>Example code for drill down operation :</p><div class="source"><pre class="prettyprint linenums">DrillExpandMember transform = model.getTransform(DrillExpandMember.class);
transform.expand(member);

// Get the updated result.
CellSet cellSet = model.getCellSet();</pre></div></div><div class="section"><h3>Generating HTML source from the PivotModel<a name="Generating_HTML_source_from_the_PivotModel"></a></h3><p>You can use the <a href="./apidocs/com/eyeq/pivot4j/ui/html/HtmlRenderer.html">HtmlRenderer</a> class to generate HTML source out of a PivotModel instance as below example :</p><div class="source"><pre class="prettyprint linenums">HtmlRenderer renderer = new HtmlRenderer(writer);

renderer.setShowDimensionTitle(false); // Optionally hide the dimension title headers.
renderer.setShowParentMembers(true); // Optionally make the parent members visible.

renderer.render(model);

writer.flush();
writer.close();</pre></div><p>You can make your own renderer class to generate a markup output of the pivot model in a suitable format. It can also be used to build a custom table model instead of writing the output immediately. Customizing the layout structure (i.e. adding arbitary headers) is also possible by implementing the <a href="./apidocs/com/eyeq/pivot4j/ui/RenderStrategy.html">RenderStrategy</a> interface, or extending one of its concrete implementations. But this feature is still experimental and might be changed in a future version.</p></div><div class="section"><h3>Saving and Restoring the Model State<a name="Saving_and_Restoring_the_Model_State"></a></h3><p>In a certain runtime environment, you need to store the current state of the PivotModel instance to be used later. For example, when you deploy on a server which distributes its sessions across the cluster you can't just store the model instance in a session as it's not serializable.</p><p>In that case, you need to retrieve state data from the active model to store it then later restore that state to serve the next client request like below :</p><div class="source"><pre class="prettyprint linenums">// From the original request, retrieve the model state and store it as a session attribute
Serializable bookmark = model.bookmarkState();

session.setAttribute(&quot;pivotState&quot;, bookmark);

...

// From the next request, retrieve the state object from the session and 
// initialize a new PivotModel instance using that state.
Serializable bookmark = (Serializable) session.getAttribute(&quot;pivotState&quot;);

PivotModel model = new PivotModelImpl(dataSource);
model.restoreState(bookmark);

// You don't need to call initialize() or setMdx() as you've already 
// done that in the previous request.
CellSet cellSet = model.getCellSet();</pre></div></div></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2012-2013
                        <a href="http://www.eyeq.co.kr">Eyeq MC</a>.
            All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
